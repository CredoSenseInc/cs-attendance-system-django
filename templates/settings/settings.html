{%extends 'base/base.html'%}
{%load static%}
{% block header %}
{% include "base/header.html" %}
<title>Settings | CredoSense</title>
<link rel="stylesheet" href="{%static ''%}css/dashboard.css">
<link rel="stylesheet" href="{%static ''%}css/settings.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"
  integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
  integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
{% endblock header %}
{%block mainbody%}

{% include "sidebar/sidebar.html" %}
<div class="content mt-3">
  {% for message in messages %}
  <div class="alert {{ message.tags }} alert-dismissible" role="alert">
    {{message}}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  {% endfor %}

  <h4>Settings</h4>
  <hr>
  <div class="row">
    <div class="col">
      <form name="atn-settings" class="form" action="{% url 'update' %}" method="post">
        {% csrf_token %}
        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Start time: </label>
          </div>
          <div class="col-auto">
            <input type="time" id="start-time" name="start-time" class="form-control" aria-describedby="startTime"
              value="{{settings.startTime|time:"H:i" }}">
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">End time: </label>
          </div>

          <div class="col-auto">
            <input type="time" id="end-time" name="end-time" class="form-control" aria-describedby="endTime"
              value="{{settings.endTime|time:"H:i" }}">
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Count late after: </label>
          </div>

          <div class="col-auto">
            <input type="time" id="delay-time" name="delay-time" class="form-control" aria-describedby="delayTime"
              value="{{settings.delayTime|time:"H:i" }}">
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Count overtime after: </label>
          </div>

          <div class="col-auto">
            <input type="time" id="delay-time" name="overtime-after" class="form-control" aria-describedby="delayTime"
              value="{{settings.overtime_count_after|time:"H:i" }}">
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Weekends: </label>
          </div>

          <div class="col-auto">
            <!-- hidden paramenter to send not checked value -->
            <input type='hidden' value='0' name="week-saturday">
            <input type="checkbox" class="btn-check" id="week-saturday" name="week-saturday" autocomplete="off"
              {% if settings.week_saturday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-saturday">Saturday</label>

            <input type='hidden' value='0' name="week-sunday">
            <input type="checkbox" class="btn-check" id="week-sunday" name="week-sunday" autocomplete="off"
              {% if settings.week_sunday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-sunday">Sunday</label>

            <input type='hidden' value='0' name="week-monday">
            <input type="checkbox" class="btn-check" id="week-monday" name="week-monday" autocomplete="off"
              {% if settings.week_monday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-monday">Monday</label>

            <input type='hidden' value='0' name="week-tuesday">
            <input type="checkbox" class="btn-check" id="week-tuesday" name="week-tuesday" autocomplete="off"
              {% if settings.week_tuesday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-tuesday">Tuesday</label>

            <input type='hidden' value='0' name="week-wednesday">
            <input type="checkbox" class="btn-check" id="week-wednesday" name="week-wednesday" autocomplete="off"
              {% if settings.week_wednesday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-wednesday">Wednesday</label>

            <input type='hidden' value='0' name="week-thursday">
            <input type="checkbox" class="btn-check" id="week-thursday" name="week-thursday" autocomplete="off"
              {% if settings.week_thursday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-thursday">Thursday</label>

            <input type='hidden' value='0' name="week-friday">
            <input type="checkbox" class="btn-check" id="week-friday" name="week-friday" autocomplete="off"
              {% if settings.week_friday %} checked {%endif%}>
            <label class="btn btn-outline-primary mb-2" for="week-friday">Friday</label>
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Additional off days: </label>
          </div>

          <div class="col-9">

            <input type="text" class="form-control off-date" name="off-days" value="{{settings.offDay}}" id="offdays"/>
            

            <!-- <input type="text" class="off-date" name="off-days" 
             style=" top: 500px; position: absolute;"/> -->

            <!-- <button type="button" id="off-date-btn" name="off-days" class="btn btn-primary off-date-btn">Primary</button> -->
            
            
            
            <!-- <textarea class="form-control off-date" name="off-days" value="{{settings.offDay}}"></textarea> -->

            <!-- <textarea class="form-control off-date" name="off-days" rows="5" placeholder="Qualification &#10;Education &#10;Background *"></textarea> -->
          </div>
        </div>

        <div class="row g-3 align-items-center mb-3">
          <div class="col-auto">
            <label for="" class="col-form-label">Additional working days: </label>
          </div>

          <div class="col-9">
            <input type="text" class="form-control work-date" name="work-days" value="{{settings.workDay}}" />
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-auto">
            <a href="{% url 'dashboard'%}"><button type="button" class="btn btn-secondary">Cancel</button></a>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </div>
      </form>
    </div>
  </div>


  
  <div class="row mt-3">
    <div class="col-12">
      <h4>Device information</h4>
      <hr>
      {% include "settings/changelog.html" %}
      {% include "settings/warning-all.html" %}
      Token: {{token}} | Latest Firmware Version: {{firmware_version.version}} | {% if all_updated %} All the devices are updated {% elif not update_all_button %} <a href="#" data-bs-toggle="modal" data-bs-target="#warning-all" style="color: #f58045;"><u><b>Update all</b></u></a>{% else %} Updating... {% endif %} | <a href="#" data-bs-toggle="modal" data-bs-target="#whatnew" style="color: #009145;"><u>See what's new</u></a>
      {% include "settings/addDeviceModal.html" %}
      <a href="#" data-bs-toggle="modal" data-bs-target="#add-dev"><i
        class="fas fa-user-plus" style="float: right; margin-left: 10px; color: rgb(0, 0, 0);" title="Add employee"></i></a>

         

      <table id="deviceTable" class="table table-striped table-hover table-responsive" style="width:100%">
        <thead>
            <tr>
                <th>Name</th>
                <th>ID</th>
                <th>Location</th>
                <th>Current Firmware</th>
                <th>Update</th>
            </tr>
        </thead>
        <tbody>


            
            {%for d in device%}
            {% include "settings/warning.html" %}
            {% include "settings/editDeviceModal.html" %}
            <tr>
                <td style="vertical-align: text-top;"><a href="#" data-bs-toggle="modal" data-bs-target="#edit-dev{{d.device_id}}">{{d.device_name}}</a></td>
                <td style="vertical-align: text-top;">{{d.device_id}}</td>
                <td style="vertical-align: text-top;">{{d.device_location}}</td>
                <td style="vertical-align: text-top;">{{d.firmware_version}}</td>
                {% if d.is_updating %}
                  <td style="vertical-align: text-top;">Updating...</td>
                {% elif  d.update_available %}
                <td style="vertical-align: text-top;"><button class="btn" data-bs-toggle="modal" data-bs-target="#update{{d.device_id}}" style="background-color: #f58045; border-color: #f58045; color: #fff;">Update to version {{firmware_version.version}}</button></td>
                {% else %}
                <td style="vertical-align: text-top;">Device is up to date</td>
                {% endif %}
            </tr>
            {%endfor%}
        </tbody>
    </table>

    
    </div>
  </div>


</div>

</div>
<script>
  var d = document.getElementById("settings");
  d.className += " active";

  var d = document.getElementById("settingsNav");
  d.className += " active";
</script>

<script>
  $(document).ready(function () {
    $('#deviceTable').DataTable({
      "searching": false,
      "lengthChange": false
    });
  });
</script>

<script>

//   $('.off-date-btn').datepicker({
//     multidate: true,
//     altField: "#offdays"
//   });
//   $('.off-date-btn').datepicker()

// //   $(".off-date-btn").click(function () {
// //     $(".off-date").datepicker("show");
// // });


  $('.off-date').datepicker({
    multidate: true
  });
  // // $('.date').datepicker('setDates', [new Date(2014, 2, 5), new Date(2014, 3, 5)])
  $('.off-date').datepicker()
</script>

<script>
  $('.work-date').datepicker({
    multidate: true
  });
  // $('.date').datepicker('setDates', [new Date(2014, 2, 5), new Date(2014, 3, 5)])
  $('.work-date').datepicker()
</script>


<script>
  $("#datepicker").datepicker({
    altField: "#alt",
    multidate: true
});
$('#datepicker').on('change', function () {
    $(this).val("")
})
</script>
{% endblock %}
